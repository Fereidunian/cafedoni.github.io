<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¬Ø²Ø¦ÛŒØ§Øª Ú©Ø§ÙÙ‡ - Ú©Ø§ÙÙ‡ Ú¯Ø±Ø¯ÛŒ ØªÙ‡Ø±Ø§Ù†</title>
    
    <!-- Styles -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/components.css">
    <link rel="stylesheet" href="../assets/css/responsive.css">
</head>
<body>

    <!-- Header (Ù‡Ù…Ø§Ù† Ù‡Ø¯Ø± ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ) -->
    <header class="site-header" id="site-header">
        <div class="container">
            <div class="header-content">
                <div class="header-logo"><a href="../index.html"><img src="../assets/images/logo.svg" alt="Ú©Ø§ÙÙ‡ Ú¯Ø±Ø¯ÛŒ ØªÙ‡Ø±Ø§Ù†"></a></div>
                <nav class="header-nav desktop-only">
                    <ul class="nav-menu">
                        <li><a href="../index.html">ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a></li>
                        <li><a href="places.html">Ú©Ø§ÙÙ‡ Ùˆ Ø±Ø³ØªÙˆØ±Ø§Ù†â€ŒÙ‡Ø§</a></li>
                        <li><a href="blog.html">ÙˆØ¨Ù„Ø§Ú¯</a></li>
                    </ul>
                </nav>
                <div class="header-actions">
                    <a href="tel:09395047710" class="btn btn-primary desktop-only">ğŸ“ <span>ØªØ¨Ù„ÛŒØºØ§Øª</span></a>
                    <button class="mobile-menu-toggle mobile-only" id="mobile-menu-toggle" aria-label="Ù…Ù†ÙˆÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„"><span class="hamburger"></span></button>
                </div>
            </div>
        </div>
    </header>

    <main class="site-main">
        <div class="container" id="cafe-detail-container">
            <!-- Ù…Ø­ØªÙˆØ§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© Ø§Ø² JSON Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
            <div class="loading">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§ÙÙ‡...</div>
        </div>

        <!-- Similar Cafes Section -->
        <section class="similar-cafes-section bg-white">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Ú©Ø§ÙÙ‡â€ŒÙ‡Ø§ÛŒ Ù…Ø´Ø§Ø¨Ù‡</h2>
                </div>
                <div class="cafe-grid" id="similar-cafes-grid">
                    <!-- Ú©Ø§ÙÙ‡â€ŒÙ‡Ø§ÛŒ Ù…Ø´Ø§Ø¨Ù‡ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                </div>
            </div>
        </section>
    </main>

    <!-- Footer (Ù‡Ù…Ø§Ù† ÙÙˆØªØ± ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ) -->
    <footer class="site-footer">
        <!-- ... Ù…Ø­ØªÙˆØ§ÛŒ Ú©Ø§Ù…Ù„ ÙÙˆØªØ± Ø±Ø§ Ø§Ø² index.html Ø§ÛŒÙ†Ø¬Ø§ Ú©Ù¾ÛŒ Ú©Ù†ÛŒØ¯ ... -->
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const cafeId = parseInt(urlParams.get('id'));

            if (!cafeId) {
                document.getElementById('cafe-detail-container').innerHTML = `<div class="error-message">Ú©Ø§ÙÙ‡ ÛŒØ§ÙØª Ù†Ø´Ø¯.</div>`;
                return;
            }

            try {
                const response = await fetch('../assets/data/cafes.json');
                const data = await response.json();
                const cafe = data.cafes.find(c => c.id === cafeId);

                if (!cafe) {
                    document.getElementById('cafe-detail-container').innerHTML = `<div class="error-message">Ú©Ø§ÙÙ‡ ÛŒØ§ÙØª Ù†Ø´Ø¯.</div>`;
                    return;
                }
                
                // Set page title
                document.title = `${cafe.name} - Ú©Ø§ÙÙ‡ Ú¯Ø±Ø¯ÛŒ ØªÙ‡Ø±Ø§Ù†`;

                renderCafeDetail(cafe);
                renderSimilarCafes(data.cafes, cafe);

            } catch (error) {
                console.error('Error loading cafe data:', error);
                document.getElementById('cafe-detail-container').innerHTML = `<div class="error-message">Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª.</div>`;
            }
        });

        function renderCafeDetail(cafe) {
            const container = document.getElementById('cafe-detail-container');
            const stars = createStarRating(cafe.rating || 0);

            container.innerHTML = `
                <article class="cafe-detail">
                    <div class="cafe-detail-gallery">
                        <img src="../${cafe.image}" alt="${cafe.name}" class="main-image">
                    </div>
                    <div class="cafe-detail-info">
                        <h1 class="cafe-title">${cafe.name}</h1>
                        <div class="cafe-meta">
                            <div class="cafe-rating-detail">${stars} (${cafe.rating || 0}/5)</div>
                            <div class="cafe-location-detail">ğŸ“ ${cafe.location.area}, ${cafe.location.address}</div>
                        </div>
                        <div class="cafe-description">
                            <p>Ù„ÙˆØ±Ù… Ø§ÛŒÙ¾Ø³ÙˆÙ… Ù…ØªÙ† Ø³Ø§Ø®ØªÚ¯ÛŒ Ø¨Ø§ ØªÙˆÙ„ÛŒØ¯ Ø³Ø§Ø¯Ú¯ÛŒ Ù†Ø§Ù…ÙÙ‡ÙˆÙ… Ø§Ø² ØµÙ†Ø¹Øª Ú†Ø§Ù¾ Ùˆ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø·Ø±Ø§Ø­Ø§Ù† Ú¯Ø±Ø§ÙÛŒÚ© Ø§Ø³Øª. Ú†Ø§Ù¾Ú¯Ø±Ù‡Ø§ Ùˆ Ù…ØªÙˆÙ† Ø¨Ù„Ú©Ù‡ Ø±ÙˆØ²Ù†Ø§Ù…Ù‡ Ùˆ Ù…Ø¬Ù„Ù‡ Ø¯Ø± Ø³ØªÙˆÙ† Ùˆ Ø³Ø·Ø±Ø¢Ù†Ú†Ù†Ø§Ù† Ú©Ù‡ Ù„Ø§Ø²Ù… Ø§Ø³Øª.</p>
                        </div>
                        <div class="cafe-facilities">
                            <h3 class="facilities-title">Ø§Ù…Ú©Ø§Ù†Ø§Øª</h3>
                            <ul class="facilities-list">
                                ${cafe.facilities.map(f => `<li>${f}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="cafe-actions">
                            <a href="${cafe.location.map_link}" target="_blank" class="btn btn-primary">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡</a>
                            <a href="tel:021000000" class="btn">ØªÙ…Ø§Ø³</a>
                        </div>
                    </div>
                </article>
            `;
        }

        function renderSimilarCafes(allCafes, currentCafe) {
            const container = document.getElementById('similar-cafes-grid');
            const similar = allCafes.filter(c => 
                c.id !== currentCafe.id && 
                (c.location.zone === currentCafe.location.zone || c.type.some(t => currentCafe.type.includes(t)))
            ).slice(0, 4);

            if (similar.length > 0) {
                container.innerHTML = similar.map(c => createCafeCard(c)).join('');
            } else {
                container.innerHTML = `<p>Ú©Ø§ÙÙ‡ Ù…Ø´Ø§Ø¨Ù‡ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>`;
            }
        }

        function createStarRating(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= rating) stars += 'â˜…';
                else stars += 'â˜†';
            }
            return stars;
        }

        function createCafeCard(cafe) {
            return `
                <div class="cafe-card">
                    <a href="cafe-detail.html?id=${cafe.id}">
                        <div class="cafe-card-image"><img src="../${cafe.image}" alt="${cafe.name}" loading="lazy"></div>
                        <div class="cafe-card-content">
                            <h3>${cafe.name}</h3>
                            <div class="cafe-rating">${createStarRating(cafe.rating || 0)}</div>
                            <div>ğŸ“ ${cafe.location?.area || ''}</div>
                        </div>
                    </a>
                </div>
            `;
        }
    </script>
</body>
</html>